# å…è´¹éƒ¨ç½²æŒ‡å— - Vercel + Render

æœ¬æŒ‡å—å°†å¸®åŠ©ä½ å°†ä»£ç å¯è§†åŒ–å·¥å…·å…è´¹éƒ¨ç½²åˆ°å…¬ç½‘ï¼Œè®©å…¶ä»–ç”¨æˆ·å¯ä»¥é€šè¿‡é“¾æ¥è®¿é—®ã€‚

## å¿«é€Ÿéƒ¨ç½²æ­¥éª¤ï¼ˆRailway ç¤ºä¾‹ï¼‰

### 1. åˆ›å»º Railway é…ç½®æ–‡ä»¶

âœ… å·²åˆ›å»º `railway.json` é…ç½®æ–‡ä»¶

### 2. æ¨é€åˆ° GitHub

```bash
git add railway.json .env.railway.example
git commit -m "chore: æ·»åŠ  Railway éƒ¨ç½²é…ç½®"
git push origin main
```

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡ GitHub ä»“åº“

1. **å°†ä»£ç æ¨é€åˆ° GitHub**
   ```bash
   git init
   git add .
   git commit -m "Initial commit"
   git branch -M main
   git remote add origin https://github.com/your-username/your-repo.git
   git push -u origin main
   ```

---

### ç¬¬äºŒæ­¥ï¼šéƒ¨ç½²åç«¯åˆ° Render

1. **è®¿é—® Render**
   - æ‰“å¼€ https://render.com
   - æ³¨å†Œ/ç™»å½•è´¦å·

2. **åˆ›å»ºæ–°çš„ Web Service**
   - ç‚¹å‡» "New" â†’ "Web Service"
   - è¿æ¥ä½ çš„ GitHub ä»“åº“
   - é€‰æ‹© `backend` ç›®å½•ä½œä¸ºæ ¹ç›®å½•

3. **é…ç½®æœåŠ¡**
   - **Name**: `code-viz-backend`
   - **Runtime**: `Python 3`
   - **Build Command**: `pip install -r requirements.txt`
   - **Start Command**: `uvicorn main:app --host 0.0.0.0 --port $PORT`

4. **é…ç½®ç¯å¢ƒå˜é‡**
   åœ¨ "Advanced" â†’ "Environment Variables" ä¸­æ·»åŠ ï¼š
   
   | å˜é‡å | å€¼ | è¯´æ˜ |
   |--------|-----|------|
   | `API_KEY` | `sk-5Ke79wdn8pr7iRlXskZPudyXPgXrUN638lx2snPhTIqqUKc1` | API å¯†é’¥ |
   | `API_BASE` | `https://new.lemonapi.site/v1` | API åŸºç¡€åœ°å€ |
   | `MODEL_NAME` | `gemini-2.5-pro` | æ¨¡å‹åç§° |
   | `PORT` | `8000` | ç«¯å£å· |

5. **éƒ¨ç½²**
   - ç‚¹å‡» "Create Web Service"
   - ç­‰å¾…éƒ¨ç½²å®Œæˆï¼ˆçº¦ 3-5 åˆ†é’Ÿï¼‰
   - å¤åˆ¶ç”Ÿæˆçš„åç«¯ URLï¼ˆä¾‹å¦‚ï¼š`https://code-viz-backend.onrender.com`ï¼‰

6. **ä¿æŒåç«¯æ´»è·ƒ**
   - Render å…è´¹å¥—é¤ä¼šåœ¨ 15 åˆ†é’Ÿæ— è¯·æ±‚åä¼‘çœ 
   - å¯ä»¥ä½¿ç”¨ https://uptimerobot.com è®¾ç½®å®šæ—¶ ping ä¿æŒæ´»è·ƒ

---

### ç¬¬ä¸‰æ­¥ï¼šéƒ¨ç½²å‰ç«¯åˆ° Vercel

1. **è®¿é—® Vercel**
   - æ‰“å¼€ https://vercel.com
   - æ³¨å†Œ/ç™»å½•è´¦å·

2. **å¯¼å…¥é¡¹ç›®**
   - ç‚¹å‡» "Add New" â†’ "Project"
   - é€‰æ‹©ä½ çš„ GitHub ä»“åº“

3. **é…ç½®é¡¹ç›®**
   - **Framework Preset**: `Vite`
   - **Root Directory**: `frontend`
   - **Build Command**: `npm run build`
   - **Output Directory**: `dist`

4. **é…ç½®ç¯å¢ƒå˜é‡**
   åœ¨ "Environment Variables" ä¸­æ·»åŠ ï¼š
   
   | å˜é‡å | å€¼ | è¯´æ˜ |
   |--------|-----|------|
   | `VITE_API_BASE_URL` | `https://your-backend-url.onrender.com/api` | åç«¯ API åœ°å€ï¼ˆæ›¿æ¢ä¸ºä½ çš„å®é™…åç«¯ URLï¼‰ |

5. **éƒ¨ç½²**
   - ç‚¹å‡» "Deploy"
   - ç­‰å¾…éƒ¨ç½²å®Œæˆï¼ˆçº¦ 1-2 åˆ†é’Ÿï¼‰
   - å¤åˆ¶ç”Ÿæˆçš„å‰ç«¯ URL

---

### ç¬¬å››æ­¥ï¼šé…ç½® CORS

**é‡è¦**ï¼šéœ€è¦ä¿®æ”¹åç«¯çš„ CORS é…ç½®ï¼Œå…è®¸å‰ç«¯åŸŸåè®¿é—®ã€‚

1. åœ¨ Render æ§åˆ¶å°ä¸­ï¼Œæ‰¾åˆ°ä½ çš„åç«¯æœåŠ¡
2. æ·»åŠ ç¯å¢ƒå˜é‡ï¼š
   - `CORS_ORIGINS`: `https://your-frontend-url.vercel.app`
3. é‡å¯åç«¯æœåŠ¡

---

## âœ… éªŒè¯éƒ¨ç½²

1. **è®¿é—®å‰ç«¯**
   - æ‰“å¼€ä½ çš„ Vercel å‰ç«¯ URL
   - æµ‹è¯•ä¸Šä¼ ä»£ç åŠŸèƒ½

2. **æ£€æŸ¥åç«¯**
   - è®¿é—® `https://your-backend-url.onrender.com/health`
   - åº”è¯¥è¿”å› `{"status":"healthy"}`

3. **æµ‹è¯•å®Œæ•´æµç¨‹**
   - ä¸Šä¼ ä¸€ä¸ªä»£ç å‹ç¼©åŒ…
   - æŸ¥çœ‹æ¶æ„å¯è§†åŒ–æ•ˆæœ
   - æµ‹è¯•ç¾¤èŠå‰§æœ¬åŠŸèƒ½

---

## ğŸ”§ å¸¸è§é—®é¢˜

### 1. åç«¯ä¼‘çœ é—®é¢˜

Render å…è´¹å¥—é¤ä¼šåœ¨ 15 åˆ†é’Ÿæ— è¯·æ±‚åä¼‘çœ ï¼Œé¦–æ¬¡è®¿é—®å¯èƒ½éœ€è¦ 30-60 ç§’å¯åŠ¨ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ä½¿ç”¨ Uptime Robot ç­‰å·¥å…·å®šæ—¶ ping
- æˆ–å‡çº§åˆ°ä»˜è´¹å¥—é¤

### 2. CORS é”™è¯¯

å¦‚æœå‰ç«¯æ— æ³•è®¿é—®åç«¯ APIï¼Œæ£€æŸ¥ï¼š
- åç«¯ `CORS_ORIGINS` æ˜¯å¦åŒ…å«å‰ç«¯ URL
- å‰ç«¯ `VITE_API_BASE_URL` æ˜¯å¦æ­£ç¡®

### 3. æ–‡ä»¶ä¸Šä¼ å¤§å°é™åˆ¶

Render å…è´¹å¥—é¤å¯¹è¯·æ±‚å¤§å°æœ‰é™åˆ¶ï¼Œå»ºè®®ï¼š
- ä¸Šä¼ çš„ä»£ç åŒ…ä¸è¶…è¿‡ 10MB
- æˆ–å‡çº§åˆ°ä»˜è´¹å¥—é¤

### 4. ChromaDB æ•°æ®æŒä¹…åŒ–

Render å…è´¹å¥—é¤é‡å¯åä¼šä¸¢å¤±æ•°æ®ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ä½¿ç”¨ Render çš„ Disk åŠŸèƒ½ï¼ˆå·²åœ¨ `render.yaml` ä¸­é…ç½®ï¼‰
- æˆ–ä½¿ç”¨äº‘æ•°æ®åº“æœåŠ¡

---

## ğŸ“Š è´¹ç”¨è¯´æ˜

| æœåŠ¡ | å…è´¹é¢åº¦ | è¯´æ˜ |
|------|----------|------|
| Vercel | å®Œå…¨å…è´¹ | æ— é™å¸¦å®½ï¼Œ100GB/æœˆ |
| Render | 750 å°æ—¶/æœˆ | è¶³å¤Ÿæ—¥å¸¸ä½¿ç”¨ |
| **æ€»è®¡** | **$0/æœˆ** | å®Œå…¨å…è´¹ |

---

## ğŸ‰ å®Œæˆï¼

ç°åœ¨ä½ çš„ä»£ç å¯è§†åŒ–å·¥å…·å·²ç»éƒ¨ç½²åˆ°å…¬ç½‘ï¼Œå…¶ä»–ç”¨æˆ·å¯ä»¥é€šè¿‡é“¾æ¥è®¿é—®äº†ï¼

**åˆ†äº«é“¾æ¥**ï¼š
- å‰ç«¯ï¼š`https://your-frontend-url.vercel.app`
- åç«¯ï¼š`https://your-backend-url.onrender.com`

---

## ğŸ“ åç»­ä¼˜åŒ–å»ºè®®

1. **æ·»åŠ è‡ªå®šä¹‰åŸŸå**
   - Vercel å’Œ Render éƒ½æ”¯æŒè‡ªå®šä¹‰åŸŸå
   - éœ€è¦è´­ä¹°åŸŸåå¹¶é…ç½® DNS

2. **å‡çº§å¥—é¤**
   - å¦‚æœéœ€è¦æ›´å¤šåŠŸèƒ½ï¼Œå¯ä»¥å‡çº§åˆ°ä»˜è´¹å¥—é¤
   - Render Starter: $7/æœˆ
   - Vercel Pro: $20/æœˆ

3. **ç›‘æ§å’Œæ—¥å¿—**
   - é…ç½®é”™è¯¯ç›‘æ§ï¼ˆå¦‚ Sentryï¼‰
   - æŸ¥çœ‹éƒ¨ç½²æ—¥å¿—

4. **æ€§èƒ½ä¼˜åŒ–**
   - æ·»åŠ  CDN åŠ é€Ÿ
   - ä¼˜åŒ–å›¾ç‰‡å’Œé™æ€èµ„æº

---

**éœ€è¦å¸®åŠ©ï¼Ÿ** å¦‚æœåœ¨éƒ¨ç½²è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œå¯ä»¥æŸ¥çœ‹ï¼š
- [Vercel æ–‡æ¡£](https://vercel.com/docs)
- [Render æ–‡æ¡£](https://render.com/docs)
